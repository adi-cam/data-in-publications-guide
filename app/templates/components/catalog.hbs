<ul class="sidebar" {{highlight linkSelector="li a" elementSelector="h2"}}>
  {{#each this.data.topics as |topic|}}
    <li>
      <a href="#{{slug topic.name}}" {{link-inline}}>
        {{topic.name}}
      </a>
    </li>
  {{/each}}
</ul>

{{#each this.data.topics as |topic|}}
  <div class="section">
    <h2 class="section__title" id={{slug topic.name}}>
      <img src="/eu-pubwiz/icons/{{slug topic.icon}}.svg" alt={{topic.name}} />

      <span>
        {{topic.title}}
      </span>
    </h2>

    <p class="section__text">
      {{topic.description}}
    </p>

    <div class="section__buttons">
      <button type="button" {{on "click" (fn this.openAll topic.recommendations)}}>
        Open All
      </button>

      <button type="button" {{on "click" (fn this.closeAll topic.recommendations)}}>
        Close All
      </button>
    </div>

    {{#each topic.recommendations as |recommendation|}}
      {{#let (get this.state recommendation.id) as |open|}}
        <div class="section__group {{if open 'section__group--open'}}">
          <h3 role="button" class="section__group__title" {{on "click" (fn this.open recommendation.id (not open))}}>
            <span>{{recommendation.title}}</span>

            {{#if open}}
              <Icons::ChevronUp />
            {{else}}
              <Icons::ChevronDown />
            {{/if}}
          </h3>

          {{#if open}}
            {{#if recommendation.image}}
              <div class="section__group__image">
                <img src="/eu-pubwiz/images/{{recommendation.image}}.svg" />
              </div>
            {{/if}}

            <h4 class="section__group__sub-title">
              Why
            </h4>

            <div class="section__group__text">
              {{{nl2br recommendation.why}}}
            </div>

            {{#if recommendation.how}}
              <h4 class="section__group__sub-title">
                How
              </h4>

              <div class="section__group__text">
                {{{nl2br recommendation.how}}}
              </div>
            {{/if}}

            {{#if recommendation.gallery.length}}
              <div class="section__group__gallery">
                <Slideshow @items={{recommendation.gallery}} as |item|>
                  <img src="/eu-pubwiz/images/{{item.image}}.svg" />
                  <p>{{item.text}}</p>
                </Slideshow>
              </div>
            {{/if}}

            {{#if recommendation.resources}}
              <h4 class="section__group__sub-title">
                Resources
              </h4>

              {{#each recommendation.resources as |resource|}}
                <div class="section__group__text">
                  <a href={{resource.link}} rel="noopener noreferrer">
                    <strong>{{resource.title}}</strong>
                    <Icons::External />
                  </a>
                </div>
              {{/each}}
            {{/if}}

            {{#if recommendation.contacts}}
              <h4 class="section__group__sub-title">
                Contacts
              </h4>

              {{#each recommendation.contacts as |contact|}}
                <div class="section__group__text">
                  <a href={{contact.link}} rel="noopener noreferrer">
                    <strong>{{contact.title}}</strong>
                    <Icons::External />
                  </a>
                </div>
              {{/each}}
            {{/if}}

            {{#if recommendation.examples}}
              <h4 class="section__group__sub-title">
                Examples
              </h4>

              {{#each recommendation.examples as |example|}}
                <div class="section__group__text section__group__text--spaced">
                  <a href={{example.link}} rel="noopener noreferrer">
                    <strong>{{example.title}}</strong>
                    <Icons::External />
                  </a>
                  <br />
                  {{example.short}}
                </div>
              {{/each}}
            {{/if}}
          {{/if}}
        </div>
      {{/let}}
    {{/each}}
  </div>
{{/each}}